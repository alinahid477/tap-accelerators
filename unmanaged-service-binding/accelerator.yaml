accelerator:
  displayName: Sample bitnami Service Claim
  description: Generate ClassClaim yaml config for Service Binding to bitnami resources (redis, rabbitmq).
  iconUrl: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB0AAAAiCAYAAACjv9J3AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAVGSURBVFhHrVd9bBRFFH8zs3u93vWobW3xoCYaUSoJWhqgUAiFhAQ1ivCPiUE0BlM0xCimUZSUchFbIIYEAcVqQjTqH4q1aTRRE4QKpYoexPAtAQVNKdBcP+72rnd7u+Ob3bl6d3C9LekveTfz3uztb97Mm/dmSeGqnZW0srqJFBbXAFEVMAgATwkFMAkQDlafmwAEdctuJHUzGv7dvBbcEut8oRefcAxStPHQLlo8ZR1whYySWS9O64/qVJKm7Jybw1c/DE9uXweBAE7JGYh3++lfKXXN5THtGCT0w2CiFwLCO9G3RBhka42j98BqQXHX8BGtJ5KIPgpts3XxlBMQ347zx9GDWRAJtYaba9+S9rxwP7H7aaJOWgmmfiE2cKUZugJJOZQXFCi6RNEFIeOAeeG7oHH2y336uW++RcJx/Zn43juLnpJZMDzQGm6an+VpvQIzKuR6Z2EgpkD8ugKs0ITyioS05seZEk58u87YpGFc3o0LMknvWr0VqPq41CYGPHGc+HYLUsA9RU/fzCKd2vAZUNcqqU0MjPgR4vvg1HGMSlzeQSRdeGtS0zgFwNql9fZAzEVA6GKbdO9JJJXL+8aiW5MaI19A78fPoEUcpNtD5UubgLCAIMXTLqIXBc/6TeDkBnD+F3ZuSMsoJq3/vrSg8ch9heuPThUPSrMj2KQkx5Fx883AeB24WTNqGV6a7tIXXcVTullRSRs0BBVpdgTKmSCUSScbl9qG4PL7fVabBU5ZEVHoZGC0FPzucXlKvHt7uqnirjPjI39C0jgDnGGE4choOpR5VvgpxqzZiTF1BlM8D/Bo5OdwX3xp3jSYtqdMXfjk3cTrW0CZWkHUgiqiuqSIPooiW6sv7O4qwlxVlCpluN+6OXztc33XDwcBujKW/yZMmlOP0bsEuHGFuf0zT5kuGkIX4mDolyGRuAh6HEW2CZTkiK1bLUoyfhELxGlzqO8jrff8Xjj5eky+OjfSSFN7QaC5GfubpeoQAbvS2koepC2vTdrQoIL/oYLy8gpLBSgHuOmQZOJGJMEh/HUC2tqclbQM0tUbyjzVtQHiK6nGrKNYAWTNH2umIQJGBJEMJOtWIcbFGOhGuP8EPffb25H9G/NMEZFOWriz/V1W5n8NX4Y3B/uFIlpJKmqFCGKrmGNrTUDa8eZg9PfujrLDr+a9OaSTej891IMROY8Ph38xwxpGoYQpz7uYyOitQYjQcU0KiuqJu6TOHIke1bSLSyDw1NjlLY1UIYy5rIxkJrpijSuy6mlueFsPbyEUsxUlDEJX0W3nsG8O4i+izUblmlKY+nKl1WaBG4khlH/wunINSv3OIlgCSdHLXFcVrryDkzmB+9eCWoY3UV3bA6GBGkXrfQ6X1vGlTEAmfJRbEnMf/tyJItpMBJZHI4El/UOBlYOojctT4v3qpyChSg0fDG3T1qzYIO02/i/ifwOlR6T1NsFnomcP29G7/0CQMCQNDeQmnUhYpO0HgkBZDQwMbtOezyZduxmoskxqEwND/wO8HT8GvZ0HeeEn7Vul2RmmTSuAsuk+8Ps9qI3zyIjHcwZSbqh33Hs/e3D6MnbP7HkAolg4x9hHZgywOYur1blLn3XV1D8GDVexujsH8XR0dhOXp45r0WNcN7rsHCtHsU9l2rPzreikUiKdD6pnDh+JdUfVS4/A2rXOP6A8+/ZtIhX+JsyLWGHwxWlJX7Sjn4YpW/ozSZ40rv+7PRY52TSuT0VfS0tZwut7hXi8y/Ea4rbKcopItGLTxZ1J6JaX9hhPJmNE0zroYGhPZEdjPw46BMB/wXNsyrxsxYcAAAAASUVORK5CYII=
  tags:
    - tanzu
    - ServiceBinding
    - RabbitMQ
    - Redis
    
  options:
    - name: clusterInstanceClassName
      inputType: select
      label: Choose Cluster Instance Class
      choices:
      - value: "rabbitmq-unmanaged"
        text: Bitnami RabbitMQ
      - value: "redis-unmanaged"
        text: Bitnami Redis
      description: Service binding instance class name. Please ask your operator for the correct one. 
      required: true

    - name: classclaimName
      inputType: text
      label: Class Claim Name
      description: AWS instance will be created prefixing using this value as well. 
      required: true
    
    - name: classclaimNamespace
      inputType: text
      label: Class Claim Namespace
      description: The namespace where this class claim CRD will be created. Application consuming this claim will need to reside in the same namespace. 
      defaultValue: "default"
      required: true

    - name: storageGB
      inputType: text
      label: Storage GB
      description: The desired storage capacity in Gigabytes.
      defaultValue: "1"
      required: true

    - name: replicasCount
      inputType: text
      label: Replicas
      description: The desired number of replicas forming the cluster
      defaultValue: "1"
      required: true
      dependsOn:
        name: clusterInstanceClassName
        value: rabbitmq-unmanaged
      

    
engine:
  merge:
    - include: ["rds-classclaim.yaml"]
      exclude: ["accelerator-log.md"]
      chain:
        - type: ReplaceText
          substitutions:
            - text: RPLC_CLUSTER_INSTANCE_CLASS_NAME
              with: "#clusterInstanceClassName"
            - text: "RPLC_NAME"
              with: "#classclaimName"
            - text: "RPLC_DEPLOYMENT_NAMESPACE"
              with: "#classclaimNamespace"
            - text: "RPLC_STORAGE_GB"
              with: "#storageGB"
        - type: ReplaceText
          condition: "#clusterInstanceClassName == 'rabbitmq-unmanaged'"
          substitutions:
            - text: "# replicas"
              with: "replicas: #replicasCount"


